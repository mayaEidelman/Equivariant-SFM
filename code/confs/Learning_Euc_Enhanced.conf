exp_name = Learning_Euc_Enhanced
random_seed=0
dataset
{
    use_gt = False
    calibrated = True
    batch_size = 4
    min_sample_size = 10
    max_sample_size = 40
    compute_pairwise = True
    images_path = "datasets/images/"  # Path to scene images
    test_set = ["Alcatraz Courtyard","Alcatraz Water Tower", "Drinking Fountain Somewhere In Zurich", "Nijo Castle Gate",
               "Porta San Donato Bologna", "Round Church Cambridge", "Smolny Cathedral St Petersburg","Some Cathedral In Barcelona",
               "Sri Veeramakaliamman Singapore", "Yueh Hai Ching Temple Singapore"]
    validation_set = ["Golden Statue Somewhere In Hong Kong", "East Indiaman Goteborg", "Pantheon Paris"]
    train_set = ["Ecole Superior De Guerre", "Door Lund", "Park Gate Clermont Ferrand", "Thian Hook Keng Temple Singapore",
        "Statue Of Liberty", "Kings College University Of Toronto", "Sri Thendayuthapani Singapore",
        "Skansen Kronan Gothenburg", "Buddah Tooth Relic Temple Singapore", "Eglise du dome", "Fort Channing Gate Singapore",
        "Gustav Vasa"]
}
model
{
    type = EnhancedSetOfSet.EnhancedSetOfSetNet
    num_features = 256
    num_blocks = 2
    block_size = 3
    use_skip = True
    multires = 0
    
    # Attention configuration
    use_attention = True
    num_heads = 8
    attention_dropout = 0.1
    
    # Visual feature configuration
    use_visual_features = True
    use_pretrained_visual = True
    visual_feature_dim = 256
    fusion_method = "gated"  # "gated", "concat", "add"
    
    # Advanced settings
    use_final_attention = True
    use_layer_norm = True
    use_residual_connections = True
}
train
{
    lr = 1e-3
    num_of_epochs = 3e+4
    scheduler_milestone = [20000]
    gamma = 0.5
    eval_intervals = 250
    optimization_num_of_epochs = 500
    optimization_eval_intervals = 250
    optimization_lr = 1e-3
}
ba
{
run_ba = True
repeat=True
triangulation=False  # If repeat, the first time is from our points and the second from triangulation
only_last_eval = True
}
loss
{
    func = CombinedLoss
    infinity_pts_margin = 1e-4
    normalize_grad = True
    hinge_loss = True
    hinge_loss_weight = 1
    
    # Unsupervised pairwise consistency loss weights
    esfm_weight = 1.0
    pairwise_weight = 0.5
    epipolar_weight = 1.0
    geometric_weight = 0.5
} 